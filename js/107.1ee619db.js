"use strict";(self["webpackChunkbro_app"]=self["webpackChunkbro_app"]||[]).push([[107],{17107:function(a,t,e){e.r(t),e.d(t,{default:function(){return O}});var s=e(73396),o=e(44870),i=e(87139),l=e(49242),r=e(21030),n=e(16006),c=e(90318),d=e(21037),_=e(39521),p=e(10996),m=e.n(p),u=e(95473),g=e(15361)["Buffer"];const v={class:"create_passport"},f={class:"cont"},b={class:"data_wrap"},y={class:"data_hide",id:"completed_passport"},w={class:"data active"},h={class:"avatar"},k={for:"avatar",class:"box hide"},z={key:0,class:"icon"},S={key:1,class:"label"},U={key:2,class:"exp"},x=(0,s._)("br",null,null,-1),$=["src"],q=(0,s.uE)('<div class="logo"><img src="'+r+'" alt=""><div class="corner corner_top_left"></div><div class="corner corner_top_right"></div><div class="corner corner_bottom_left"></div><div class="corner corner_bottom_right"></div></div>',1),D={class:"info"},I={class:"line"},C={class:"field"},N={class:"label"},j=["value"],A={class:"line"},E={class:"field"},L={class:"label"},P={class:"line citizenship"},B={class:"field"},F={class:"label"},G={class:"text"},T=(0,s._)("img",{src:n,alt:"",class:"img"},null,-1),H=(0,s.uE)('<div class="bg_line"><div class="corner corner_top_left"></div><div class="corner corner_top_right"></div><div class="corner corner_bottom_left"></div><div class="corner corner_bottom_right"></div></div><div class="bg_left"></div><div class="bg_right"></div><div class="bg_bottom"></div>',4),M={class:"bottom_btns"},R={key:0,for:"avatar",class:"btn change_image_btn"},V=["onClick"],X=["href"];var J={__name:"Passport",setup(a){const t=(0,c.s)(),e=(0,s.f3)("i18n"),r=(0,d.lm)();var n=(0,o.iH)(null),p=(0,o.qj)({src:"",buffer:"",status:!1}),J=(0,o.qj)({moonAddress:(0,s.Fl)((()=>t.wallets.bostrom?t.wallets.bostrom:"")),nickName:"",passportImage:"",status:!1,bgGradient:"",changeImage:!1});function K(){let a=new FormData;if(p.src="",n.value.files[0].size/1024/1024<=5){a.append("avatar",n.value.files[0]);let t=new FileReader;t.onload=async()=>{p.buffer=g(t.result),p.src=t.result,p.status=!0,setTimeout((()=>document.querySelector(".create_passport .avatar .image.animated").classList.remove("animated")),800)},t.readAsDataURL(n.value.files[0])}else r.notify({group:"default",durartion:5e3,title:e.global.t("message.notification_error_file_size_title"),text:e.global.t("message.notification_error_file_size_text",{size:"5mb"}),type:"error"})}async function O(){r.notify({group:"default",duration:-100,title:e.global.t("message.notification_passport_update_process")}),J.status=!0;try{let a=await t.node.add(n.value.files[0]),s=await(0,u.DP)({update_avatar:{new_avatar:a.path,nickname:J.nickName}}),o=await(0,u.pi)(s);0===o.code&&(t.lastTXS=o.transactionHash,r.notify({group:"default",clean:!0}),r.notify({group:t.networks.bostrom.denom,title:e.global.t("message.notification_success_update_passport_title"),type:"success",data:{chain:"bostrom",tx_type:e.global.t("message.notification_action_update_passport")}}),p.buffer="",_.hi(document.getElementById("completed_passport"),{quality:1}).then((a=>J.passportImage=a)).catch((a=>console.error(a))),await t.getMoonPassport(),t.account.avatar=p.src),o.code&&(r.notify({group:"default",clean:!0}),r.notify({duration:-100,group:t.networks.bostrom.denom,title:e.global.t("message.notification_failed_title"),text:o?.rawLog.toString(),type:"error",data:{chain:"bostrom",tx_type:e.global.t("message.notification_action_update_passport")}}))}catch(a){console.log(a),r.notify({group:"default",clean:!0}),r.notify({group:t.networks.bostrom.denom,title:e.global.t("message.notification_failed_title"),text:e.global.t("message.manage_modal_error_rejected"),type:"error",data:{chain:"bostrom",tx_type:e.global.t("message.notification_action_update_passport")}})}}return(0,s.bv)((()=>{J.nickName=t.account.moonPassport.extension.nickname,p.src=t.account.avatar,p.status=!0,setTimeout((()=>document.querySelector(".create_passport .avatar .image.animated").classList.remove("animated")),800),J.bgGradient=m()(J.nickName),_.hi(document.getElementById("completed_passport"),{quality:1}).then((a=>J.passportImage=a)).catch((a=>console.error(a)))})),(a,t)=>((0,s.wg)(),(0,s.iD)("section",v,[(0,s._)("div",f,[(0,s._)("div",b,[(0,s._)("div",y,[(0,s._)("div",w,[(0,s._)("div",h,[(0,s._)("input",{type:"file",id:"avatar",ref_key:"avatar",ref:n,accept:"image/png, image/jpeg",onChange:K},null,544),(0,s._)("label",k,[(0,o.SU)(p).status?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",z)),(0,o.SU)(p).status?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",S,(0,i.zw)(a.$t("message.passport_avatar_label")),1)),(0,o.SU)(p).status?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",U,[(0,s.Uk)((0,i.zw)(a.$t("message.passport_avatar_file_size")),1),x,(0,s.Uk)(" "+(0,i.zw)(a.$t("message.passport_avatar_mimetype_size")),1)])),(0,s._)("div",{class:(0,i.C_)(["image",{show:(0,o.SU)(p).src,animated:(0,o.SU)(p).src}])},[(0,s._)("div",null,[(0,s._)("img",{src:(0,o.SU)(p).src,alt:""},null,8,$)])],2)]),q]),(0,s._)("form",D,[(0,s._)("div",I,[(0,s._)("div",C,[(0,s._)("div",N,(0,i.zw)(a.$t("message.passport_address_exp")),1),(0,s._)("input",{type:"text",value:(0,o.SU)(J).moonAddress.slice(0,12)+"..."+(0,o.SU)(J).moonAddress.slice(-5),class:"input",readonly:""},null,8,j)])]),(0,s._)("div",A,[(0,s._)("div",E,[(0,s._)("div",L,(0,i.zw)(a.$t("message.passport_name_label")),1),(0,s.wy)((0,s._)("input",{type:"text",name:"name","onUpdate:modelValue":t[0]||(t[0]=a=>(0,o.SU)(J).nickName=a),class:"input",readonly:""},null,512),[[l.nr,(0,o.SU)(J).nickName]])])]),(0,s._)("div",P,[(0,s._)("div",B,[(0,s._)("div",F,(0,i.zw)(a.$t("message.passport_citizenship_label")),1),(0,s._)("div",G,(0,i.zw)(a.$t("message.passport_citizenship_text")),1),T])])]),H,(0,s._)("div",{class:"gradient",style:(0,i.j5)({background:(0,o.SU)(J).bgGradient})},null,4)])])]),(0,s._)("div",M,[!(0,o.SU)(p).buffer.length||(0,o.SU)(J).status?((0,s.wg)(),(0,s.iD)("label",R,(0,i.zw)(a.$t("message.change_image_btn")),1)):((0,s.wg)(),(0,s.iD)("button",{key:1,class:"btn update_btn",onClick:(0,l.iM)(O,["prevent"])},(0,i.zw)(a.$t("message.update_btn")),9,V)),(0,s._)("a",{href:(0,o.SU)(J).passportImage,download:"my_passport.png",class:"btn download_btn"},(0,i.zw)(a.$t("message.download_png_btn")),9,X)])])]))}};const K=J;var O=K}}]);
//# sourceMappingURL=107.1ee619db.js.map